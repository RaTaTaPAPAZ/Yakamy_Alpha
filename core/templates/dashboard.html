{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Yakamy</title>
    <link rel="stylesheet" href="{% static 'gallery/style.css' %}">
</head>
<body>

<header class="topbar">
    <button class="burger" onclick="toggleSidebar()">‚ò∞</button>
    <h1>Yakamy</h1>
</header>

<div class="app">

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <span>–ê–∫–∫–∞—É–Ω—Ç</span>
        </div>

        <nav class="sidebar-content">
            <a href="{% url 'logout' %}" class="btn">–í—ã–π—Ç–∏</a>
        </nav>
    </aside>

    <!-- OVERLAY -->
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

    <!-- MAIN -->
    <main class="dashboard">

        <!-- NOTES -->
        <section>
            <h2>
                –ó–∞–º–µ—Ç–∫–∏
                <a href="{% url 'create_note' %}" class="btn small">+ –ù–æ–≤–∞—è</a>
            </h2>

            <ul>
                {% for note in notes %}
                    <li>
                        {{ note.title }}
                        <span class="actions">
                            <a href="{% url 'edit_note' note.id %}">‚úèÔ∏è</a>
                            <a href="{% url 'delete_note' note.id %}">üóë</a>
                        </span>
                    </li>
                {% empty %}
                    <li class="empty">–ó–∞–º–µ—Ç–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç</li>
                {% endfor %}
            </ul>
        </section>

        <!-- MCP -->
        <section class="mcp">
            <h2>MCP</h2>

            {% if request.session.mcp %}
                {% if request.session.mcp.question %}
                    <div class="mcp_message">
                        {{ request.session.mcp.question }}
                    </div>
                {% endif %}
            {% endif %}

            <form method="post"
                  action="{% if request.session.mcp %}{% url 'mcp_clarify' %}{% else %}{% url 'mcp_create' %}{% endif %}">
                {% csrf_token %}

                <input
                    type="text"
                    name="{% if request.session.mcp %}answer{% else %}text{% endif %}"
                    placeholder="–ù–∞–ø–æ–º–Ω–∏ –∑–∞–≤—Ç—Ä–∞ –∫—É–ø–∏—Ç—å —Ö–ª–µ–±"
                    autocomplete="off"
                    class="{% if request.session.mcp %}mcp-active{% endif %}"
                >

                <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
        </section>

        <!-- REMINDERS -->
        <section>
            <h2>
                –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
            </h2>

            <ul>
                {% for reminder in reminders %}
                    <li>
                        {{ reminder.text }}
                        <small>
                            {{ reminder.remind_at|date:"d.m.Y H:i" }}
                        </small>
                        <span class="actions">
                            <a href="{% url 'delete_reminder' reminder.id %}">üóë</a>
                        </span>
                    </li>
                {% empty %}
                    <li class="empty">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</li>
                {% endfor %}
            </ul>
        </section>

        <!-- TASKS -->
        <section>
            <h2>
                –ó–∞–¥–∞—á–∏
                <a href="{% url 'create_task' %}" class="btn small">+ –ù–æ–≤–∞—è</a>
            </h2>

            <ul>
                {% for task in tasks %}
                    <li>
                        {{ task.title }}
                        <span class="actions">
                            <a href="{% url 'edit_task' task.id %}">‚úèÔ∏è</a>
                            <a href="{% url 'delete_task' task.id %}">üóë</a>
                        </span>
                    </li>
                {% empty %}
                    <li class="empty">–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç</li>
                {% endfor %}
            </ul>
        </section>

    </main>
</div>

<script>
function toggleSidebar() {
    document.body.classList.toggle('sidebar-open');
}
</script>

</body>
</html>
